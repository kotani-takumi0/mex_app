# Implementation Plan

- [x] 1. `/document` スキルの Step 3 ドキュメント構造を新しい4セクション階層構造に書き換える
- [x] 1.1 現行の5セクション構造を4セクション階層構造テンプレートに差し替える
  - 現行の「概要 / 技術的ポイント / 使用技術 / コード例・アーキテクチャ / 参考リンク」を削除し、以下の4セクションに置き換える
  - **実装サマリー**: ユーザーの機能レベル指示を冒頭に明記し、AIが構築した機能の概要を技術用語最小限で1〜3文にまとめ、git diff/log から変更規模（ファイル数・行数）を含める指示を記述する
  - **技術分解**: 機能を実現するために必要な技術要素を箇条書きで列挙し、各要素に「要素名 — 機能全体における役割」の形式で1文の説明を付け、処理の流れに沿った論理順序で並べる指示を記述する
  - **各技術要素の解説**: 技術分解で列挙した各要素について4段階（それは何か / なぜ必要か / 他の選択肢 / 壊れたらどうなるか）で解説を生成する指示を記述する。専門用語は減らさず文脈で理解させる方針、コア技術は詳細・補助は簡潔の深さ調整、git diff から具体的な設定値・ライブラリ名・関数名を引用する品質制約を含める
  - **想定Q&A**: 基礎（「そもそも何？」レベル）→ 判断（設計・技術選定の理由）→ 応用（エッジケース・障害・スケール対応）の3段階でQ&Aを生成する指示を記述する。各段階最低2問・合計6問以上、回答は「結論→理由→具体例」の構造、セキュリティ関連技術がある場合は追加質問を含める制約を記述する
  - Q&Aの質問は汎用的なものだけでなく、実装コードの具体的な設計判断に紐づいたものを含める品質制約を記述する
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 6.1, 6.2, 6.3_

- [x] 1.2 エッジケース処理ルールを追加する
  - git diff が空またはコンフィグ変更のみの場合、技術分解セクションを簡略化する指示を追加する
  - 非常に小さな変更（typo修正等）の場合、Q&Aセクションを省略しサマリーのみにする指示を追加する
  - Notionの見出しブロック（H2/H3）で各セクションを区切り、目次として機能する階層構造にする指示を明記する
  - _Requirements: 5.1, 5.2_

- [x] 2. スキル定義の補足セクションを新構造に合わせて更新する
- [x] 2.1 background_information と Step 5 結果報告を更新する
  - background_information の Mission 記述を「実装内容の作業報告」から「AIで実装したコードの技術理解を促進するドキュメント生成」に変更する
  - Step 5 の結果報告フォーマットに、生成されたドキュメントの構造概要（セクション数、Q&A問数等）を含める形式に更新する
  - 既存のワークフロー（Step 1〜Step 4）と save_document のパラメータ（title, category, technologies, source_url）は変更しない
  - _Requirements: 5.3, 5.4_

- [x] 3. 手動検証で生成品質を確認する
- [x] 3.1 複数の技術要素を含む実装でドキュメント生成を実行し、全セクションの構造と品質を検証する
  - 認証機能やAPI実装など、複数の技術要素（3個以上）を含む実装変更に対して `/document` を実行する
  - 生成されたNotionページが4セクション構造（実装サマリー、技術分解、各技術解説、想定Q&A）を含むことを確認する
  - 技術解説にgit diffからの具体的な値（ライブラリ名、設定値、関数名）が引用されていることを確認する
  - Q&Aが基礎→判断→応用の3段階で構成され、合計6問以上あることを確認する
  - MEX App への記録が正常に完了し、source_url にNotionページURLが設定されていることを確認する
  - _Requirements: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 6.1, 6.2, 6.3_

- [x]* 3.2 軽微な変更でエッジケースの挙動を検証する
  - typo修正やコンフィグ変更など、技術要素が少ない変更に対して `/document` を実行する
  - 技術分解が適切に簡略化されること、Q&Aが省略されてもドキュメントが破綻しないことを確認する
  - _Requirements: 5.1, 5.2_
